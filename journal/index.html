
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <title>426 Project</title>
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<link href="vendor/speech-input.css" rel="stylesheet">
  <link href="vendor/widearea.css" rel="stylesheet">
  <link href="vendor/jquery.gridster.css" rel="stylesheet">
  <link href="custom.css" rel="stylesheet"></style>

	<script type="text/javascript" src="vendor/colorpicker.min.js"></script>
  <script type="text/javascript" src="vendor/jquery-2.1.4.min.js"></script>
  <script type="text/javascript" src="vendor/jquery-1.11.3.js"></script>
  <script type="text/javascript" src="vendor/widearea.js"></script>
  <script type="text/javascript" src="custom.js"></script>
  <!--<script type="text/javascript" src="vendor/speech-input.js"></script>-->

  </head>

  <body>
      <!-- Gridster -->
  <div class="gridster">
    <ul>
      <li id="picker_grid" data-row="1" data-col="1" data-sizex="1" data-sizey="1">
        <div id="picker"></div>
        <div id="slide"></div>
      </li>
      <li data-row="2" data-col="3" data-sizex="1" data-sizey="1">empty</li>
      <li id ="text_grid" data-row="1" data-col="2" data-sizex="3" data-sizey="1">
        <div id="wrap">
          <div class="container">
            <div class="page-header">
              <h1 style="font-weight: normal;"><strong>Journal</strong></h1>
              <div class="clearfix"></div>
            </div>
            <form method="POST" action="">
              <div id="widearea-container">
                  <textarea placeholder="Type something..." data-widearea="enable" id="journal-input" name="journal-input"></textarea>
              </div>
              <input type="submit" id="submit" value="send" name="submit">
            </form>
          </div>
        </div>
       </li>

      <li id ="task_list" data-row="2" data-col="4" data-sizex="1" data-sizey="1">
        <div class="wrap2">

        <div class="task-list">
          <ul>

            <?php
              require("includes/connect.php");

              $query = mysql_query("SELECT * FROM tasks ORDER BY date ASC, time ASC");
              $numrows = mysql_num_rows($query);

              if($numrows>0){
                while( $row = mysql_fetch_assoc( $query ) ){

                  $task_id = $row['id'];
                  $task_name = $row['task'];

                  echo '<li>
                      <span>'.$task_name.'</span>
                      <img id="'.$task_id.'" class="delete-button" width="10px" src="../img/close.svg" />
                      </li>';
                }
              }

            ?>            
          </ul>
        </div>
      </div>
        <form class="add-new-task" autocomplete="off">
          <input type="text" name="new-task" placeholder="Add a new item..." />
        </form>
      </li>
      <li data-row="2" data-col="2" data-sizex="1" data-sizey="1">calendar</li>
      <li data-row="2" data-col="1" data-sizex="1" data-sizey="1">empty</li>

    </ul>
  </div>

  <script type="text/javascript" src="vendor/jquery-1.11.3.js"></script>
  <script src="vendor/jquery.gridster.js" type="text/javascript" charset="utf-8"></script>
      <li id="picker_grid" data-row="1" data-col="1" data-sizex="1" data-sizey="1">
        <div id="color-picker" class="cp-default">
            <div class="picker-wrapper">
                <div id="picker" class="picker"></div>
                <div id="picker-indicator" class="picker-indicator"></div>
            </div>
            <div class="slide-wrapper">
                <div id="slide" class="slide"></div>
                <div id="slide-indicator" class="slide-indicator"></div>
            </div>
        </div>
      </li>
    </ul>
  </div>
  <div id="returntext"></div> 
  <script src="vendor/jquery.gridster.js" type="text/javascript" charset="utf-8"></script>
  <script type="text/javascript">wideArea();</script>
  <script type = "text/javascript">
    
    add_task(); // Call the add_task function
    delete_task(); // Call the delete_task function

    function add_task() {

      $('.add-new-task').submit(function(){

        var new_task = $('.add-new-task input[name=new-task]').val();

        if(new_task != ''){

          $.post('includes/add-task.php', { task: new_task }, function( data ) {

            $('.add-new-task input[name=new-task]').val('');

            $(data).appendTo('.task-list ul').hide().fadeIn();

            delete_task();
          });
        }

        return false; // Ensure that the form does not submit twice
      });
    }

    function delete_task() {

      $('.delete-button').click(function(){

        var current_element = $(this);

        var id = $(this).attr('id');

        $.post('includes/delete-task.php', { task_id: id }, function() {

          current_element.parent().fadeOut("fast", function() { $(this).remove(); });
        });
      });
    }

  </script>
  <script type="text/javascript">
    var gridster;
    $(function(){
        $(".gridster ul").gridster({
          widget_base_dimensions: [250, 210],
          widget_margins: [5, 5],
          helper: 'clone',
          avoid_overlapped_widgets: true,
          autogenerate_stylesheet: true,
          //widget_margins: [5, 5],
          helper: 'clone',
          avoid_overlapped_widgets: true//,
          // resize: {
          //   enabled: true,
          //   max_size: [4, 4],
          //   min_size: [1, 1],
          // }
        }).data('gridster');

        // resize widgets on hover
        // gridster.$el
        //   .on('mouseenter', '> li', function() {
        //       gridster.resize_widget($(this), 3, 3);
        //   })
        //   .on('mouseleave', '> li', function() {
        //       gridster.resize_widget($(this), 1, 1);
        //   });

      });
    </script>
  </body>
</html>
